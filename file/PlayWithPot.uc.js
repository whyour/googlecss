// ==UserScript==
// @name           PlayWithPot.uc
// @description    用PotPlayer播放m3u列表，m3u需要设置为potplayer转用
// @include        chrome://browser/content/browser.xul
// ==/UserScript==

location == "chrome://browser/content/browser.xul" && (function () {
	(function (m) {
		m.id = "bofangPotPlayer";
		m.addEventListener("command", function () {
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			try {
				var path = Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getCharPref("browser.cache.disk.parent_directory") + "\\" + new Date().getTime() + ".m3u";
				file.initWithPath(path);
			} catch (e) {
				var path = Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties).get("ProfLD", Components.interfaces.nsILocalFile).path + "\\" + new Date().getTime() + ".m3u";
			}
			file.initWithPath(path);
			var x = gContextMenu.mediaURL || gContextMenu.linkURL;
			//alert("x='"+x+"' path='"+path+"'");
			Cc["@mozilla.org/embedding/browser/nsWebBrowserPersist;1"].createInstance(Ci.nsIWebBrowserPersist).saveURI(Cc["@mozilla.org/network/io-service;1"].getService(Ci.nsIIOService).newURI(x, null, null), null, null, null, null, null, file, null);
			setTimeout(function () {
				file.launch();
			}, 100);
		}, false);
		m.setAttribute("label", "\u76f4\u63a5\u64ad\u653e\u005f\u0050\u006f\u0074");
		m.setAttribute("accesskey", "L");
		m.setAttribute("class", "menuitem-iconic");
		m.setAttribute("image", "data:image/png;base64,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");
	})(document.getElementById("contentAreaContextMenu").insertBefore(document.createElement("menuitem"), document.getElementById("context-viewbgimage")));
	document.getElementById("contentAreaContextMenu").addEventListener("popupshowing", function () {
		gContextMenu.showItem("openImgRar", gContextMenu.onLink);
	}, false);
})()